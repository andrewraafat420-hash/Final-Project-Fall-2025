<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø·Ø¨ÙŠ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„ØªØ´Ø®ÙŠØµ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; text-align: center; }
        .container { background: white; max-width: 600px; margin: 40px auto; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; margin-bottom: 30px; }
        
        .select-box { margin-bottom: 20px; text-align: right; }
        label { font-weight: bold; color: #555; display: block; margin-bottom: 8px; }
        select, input[type="file"] { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 10px; font-family: 'Cairo'; font-size: 16px; box-sizing: border-box; }
        select:focus { border-color: #3498db; outline: none; }
        
        .upload-area { border: 2px dashed #3498db; padding: 30px; border-radius: 15px; background-color: #f9fcff; cursor: pointer; transition: 0.3s; }
        .upload-area:hover { background-color: #e6f7ff; }
        
        button { background-color: #3498db; color: white; border: none; padding: 15px 40px; font-size: 18px; border-radius: 30px; cursor: pointer; margin-top: 20px; width: 100%; font-weight: bold; transition: 0.3s; }
        button:hover { background-color: #2980b9; transform: translateY(-2px); }
        
        #result-card { display: none; margin-top: 30px; padding: 20px; border-radius: 15px; animation: fadeIn 0.5s; }
        .safe { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .danger { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø¬Ù…Ù„Ø© Ø¥Ø®Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© */
        .disclaimer {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(0,0,0,0.1);
            font-size: 13px;
            color: #666;
            font-weight: bold;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .preview-img { max-width: 100%; max-height: 300px; border-radius: 10px; margin-top: 15px; display: none; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ©º Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´Ø®ÙŠØµ Ø§Ù„Ø°ÙƒÙŠ Ø¨Ø§Ù„Ù€ AI</h1>
    
    <form id="diagnosis-form">
        <div class="select-box">
            <label>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ÙØ­Øµ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</label>
            <select name="disease_type" id="disease-select">
                <option value="cte">ğŸ§  ÙØ­Øµ Ø§Ù„Ø¬Ù„Ø·Ø§Øª Ø§Ù„Ø¯Ù…Ø§ØºÙŠØ© (Brain Stroke)</option>
                <option value="malaria">ğŸ©¸ ÙØ­Øµ Ø§Ù„Ù…Ù„Ø§Ø±ÙŠØ§ (Malaria Cells)</option>
            </select>
        </div>

        <div class="upload-area" onclick="document.getElementById('file-input').click()">
            <p>ğŸ“‚ Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ø£Ø´Ø¹Ø© Ø£Ùˆ Ø§Ù„Ø¹ÙŠÙ†Ø©</p>
            <input type="file" name="file" id="file-input" accept="image/*" style="display: none;" required onchange="previewImage(this)">
            <img id="img-preview" class="preview-img" src="" alt="preview">
        </div>

        <button type="submit" id="submit-btn">Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„</button>
    </form>

    <div id="result-card">
        <h2 id="result-title" style="margin:0"></h2>
        <p id="result-conf" style="margin:10px 0 0 0"></p>
        
        <div class="disclaimer">
            âš ï¸ ØªÙ†ÙˆÙŠÙ‡: Ù‡Ø°Ù‡ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„Ø£ØºØ±Ø§Ø¶ Ø¨Ø­Ø«ÙŠØ© ÙˆÙ„ÙŠØ³Øª ØªØ´Ø®ÙŠØµÙ‹Ø§ Ø·Ø¨ÙŠÙ‹Ø§ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§. ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø§Ù„Ù…Ø®ØªØµ.
        </div>
    </div>
</div>

<script>
    const form = document.getElementById('diagnosis-form');
    const resultCard = document.getElementById('result-card');
    const resultTitle = document.getElementById('result-title');
    const resultConf = document.getElementById('result-conf');
    const submitBtn = document.getElementById('submit-btn');

    // Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø±ÙØ¹
    function previewImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('img-preview').src = e.target.result;
                document.getElementById('img-preview').style.display = 'block';
            }
            reader.readAsDataURL(input.files[0]);
        }
    }

    form.onsubmit = async (e) => {
        e.preventDefault();
        
        submitBtn.innerHTML = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©... â³";
        submitBtn.disabled = true;
        resultCard.style.display = 'none';

        const formData = new FormData(form);

        try {
            const response = await fetch('/predict', {
                method: 'POST',
                body: formData
            });

            const data = await response.json();
            
            resultCard.style.display = 'block';
            submitBtn.innerHTML = "Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„";
            submitBtn.disabled = false;

            if (data.error) {
                resultCard.className = 'danger';
                resultTitle.innerText = "Ø®Ø·Ø£: " + data.error;
                resultConf.innerText = "";
            } else {
                if (data.is_danger) {
                    resultCard.className = 'danger';
                    resultTitle.innerText = "âš ï¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©: " + data.result;
                } else {
                    resultCard.className = 'safe';
                    resultTitle.innerText = "âœ… Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø³Ù„Ø¨ÙŠØ©: " + data.result;
                }
                resultConf.innerText = "Ù†Ø³Ø¨Ø© Ø§Ù„Ø«Ù‚Ø©: " + data.confidence;
            }
        } catch (error) {
            resultCard.style.display = 'block';
            resultCard.className = 'danger';
            resultTitle.innerText = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±";
            submitBtn.innerHTML = "Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„";
            submitBtn.disabled = false;
        }
    };
</script>

</body>
</html>